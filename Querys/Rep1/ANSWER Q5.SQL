

SELECT 

T2.OA, T2.DENUMIREA, T2.SECTOR, T2.MASA, T2.INDPESECT, T2.GRUPA,AVG(T2.D), T2.YEAR1,T2.PERIOD
 FROM 
(SELECT
    T1.D, T1.OA, T1.DENUMIREA, T1.SECTOR, T1.MASA, T1.INDPESECT, T1.GRUPA, 
    EXTRACT(YEAR FROM T1.DATA) YEAR1,
    CASE WHEN EXTRACT(MONTH FROM T1.DATA) IN (3,4,5)   THEN 2
         WHEN EXTRACT(MONTH FROM T1.DATA) IN (6,7,8)   THEN 3
         WHEN EXTRACT(MONTH FROM T1.DATA) IN (9,10,11) THEN 4
    ELSE 1 END PERIOD
FROM R_TEMP1 T1
WHERE EXTRACT(YEAR FROM T1.DATA) = 1957
)T2 
GROUP BY T2.YEAR1,T2.PERIOD,T2.OA, T2.DENUMIREA, T2.SECTOR, T2.MASA, T2.INDPESECT, T2.GRUPA
ORDER BY                    T2.OA, T2.DENUMIREA, T2.SECTOR, T2.MASA, T2.INDPESECT, T2.GRUPA